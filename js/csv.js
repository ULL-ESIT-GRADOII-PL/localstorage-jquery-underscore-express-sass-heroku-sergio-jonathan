!function(exports){"use strict";var regexp=/"((?:[^"\\]|\\.)*)"|([^,\s]+)|,\s*(?=,|$)|^\s*,/g;exports.calculate=function(original){var firstLine,lines=original.split(/\n+\s*/);for(var i in lines)if(lines[i].match(regexp)){firstLine=i;var commonLength=lines[i].match(regexp).length;break}var r=[],removeQuotes=function(field){var removecomma=field.replace(/,\s*$/,""),remove1stquote=removecomma.replace(/^\s*"/,""),removelastquote=remove1stquote.replace(/"\s*$/,""),removeescapedquotes=removelastquote.replace(/\\"/,'"');return removeescapedquotes};for(var t in lines){var temp=lines[t],m=temp.match(regexp),result=[],error=!1,first=!1;if(!temp.match(/(^\s*$)|(^#.*)/))if(m){result=m.map(removeQuotes),error=commonLength!=m.length,first=firstLine==t;var rowclass=error?"error":"";rowclass=first?"first":rowclass,r.push({value:result,rowClass:rowclass})}else{var errmsg='La fila "'+temp+'" no es un valor de CSV permitido.';r.push({value:errmsg.split("").splice(commonLength),rowClass:"error"})}}return r}}(this);